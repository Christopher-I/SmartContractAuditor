{"version":3,"file":"web3-shh.umd.js","sources":["../src/Shh.js","../src/factories/MethodModelFactory.js","../src/factories/ShhModuleFactory.js","../src/index.js"],"sourcesContent":["/*\n    This file is part of web3.js.\n\n    web3.js is free software: you can redistribute it and/or modify\n    it under the terms of the GNU Lesser General Public License as published by\n    the Free Software Foundation, either version 3 of the License, or\n    (at your option) any later version.\n\n    web3.js is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU Lesser General Public License for more details.\n\n    You should have received a copy of the GNU Lesser General Public License\n    along with web3.js.  If not, see <http://www.gnu.org/licenses/>.\n*/\n/**\n * @file Shh.js\n * @author Samuel Furter <samuel@ethereum.org>\n * @date 2017\n */\n\nimport {AbstractWeb3Module} from 'web3-core';\n\nexport default class Shh extends AbstractWeb3Module {\n    /**\n     * @param {AbstractProviderAdapter|EthereumProvider} provider\n     * @param {ProvidersModuleFactory} providersModuleFactory\n     * @param {Object} providers\n     * @param {MethodController} methodController\n     * @param {MethodModelFactory} methodModelFactory\n     * @param {SubscriptionsFactory} subscriptionsFactory\n     * @param {Network} net\n     * @param {Object} options\n     *\n     * @constructor\n     */\n    constructor(\n        provider,\n        providersModuleFactory,\n        providers,\n        methodController,\n        methodModelFactory,\n        subscriptionsFactory,\n        net,\n        options\n    ) {\n        super(provider, providersModuleFactory, providers, methodController, methodModelFactory, options);\n\n        this.subscriptionsFactory = subscriptionsFactory;\n        this.net = net;\n    }\n\n    /**\n     * Subscribe to whisper streams\n     *\n     * @method subscribe\n     *\n     * @param {string} method\n     * @param {Object} options\n     * @param {Function} callback\n     *\n     * @callback callback callback(error, result)\n     * @returns {Subscription}\n     */\n    subscribe(method, options, callback) {\n        if (method === 'messages') {\n            return this.subscriptionsFactory.createShhMessagesSubscription(this, options).subscribe(callback);\n        }\n\n        throw new Error(`Unknown subscription: ${method}`);\n    }\n\n    /**\n     * Extends setProvider method from AbstractWeb3Module.\n     * This is required for updating the provider also in the sub package Net.\n     *\n     * @param {Object|String} provider\n     * @param {Net} net\n     *\n     * @returns {Boolean}\n     */\n    setProvider(provider, net) {\n        return !!(super.setProvider(provider, net) && this.net.setProvider(provider, net));\n    }\n\n    /**\n     * Sets the defaultGasPrice property on the current object and the network module\n     *\n     * @property defaultGasPrice\n     *\n     * @param {String} value\n     */\n    set defaultGasPrice(value) {\n        super.defaultGasPrice = value;\n        this.net.defaultGasPrice = value;\n    }\n\n    /**\n     * Sets the defaultGas property on the current object and the network module\n     *\n     * @property defaultGas\n     *\n     * @param {Number} value\n     */\n    set defaultGas(value) {\n        super.defaultGas = value;\n        this.net.defaultGas = value;\n    }\n\n    /**\n     * Sets the transactionBlockTimeout property on the current object and the network module\n     *\n     * @property transactionBlockTimeout\n     *\n     * @param {Number} value\n     */\n    set transactionBlockTimeout(value) {\n        super.transactionBlockTimeout = value;\n        this.net.transactionBlockTimeout = value;\n    }\n\n    /**\n     * Sets the transactionConfirmationBlocks property on the current object and the network module\n     *\n     * @property transactionConfirmationBlocks\n     *\n     * @param {Number} value\n     */\n    set transactionConfirmationBlocks(value) {\n        super.transactionConfirmationBlocks = value;\n        this.net.transactionConfirmationBlocks = value;\n    }\n\n    /**\n     * Sets the transactionPollingTimeout property on the current object and the network module\n     *\n     * @property transactionPollingTimeout\n     *\n     * @param {Number} value\n     */\n    set transactionPollingTimeout(value) {\n        super.transactionPollingTimeout = value;\n        this.net.transactionPollingTimeout = value;\n    }\n\n    /**\n     * Sets the defaultAccount property on the current object and the network module\n     *\n     * @property defaultAccount\n     *\n     * @param {String} value\n     */\n    set defaultAccount(value) {\n        super.defaultAccount = value;\n        this.net.defaultAccount = value;\n    }\n\n    /**\n     * Sets the defaultBlock property on the current object and the network module\n     *\n     * @property defaultBlock\n     *\n     * @param value\n     */\n    set defaultBlock(value) {\n        super.defaultBlock = value;\n        this.net.defaultBlock = value;\n    }\n}\n","/*\n This file is part of web3.js.\n\n web3.js is free software: you can redistribute it and/or modify\n it under the terms of the GNU Lesser General Public License as published by\n the Free Software Foundation, either version 3 of the License, or\n (at your option) any later version.\n\n web3.js is distributed in the hope that it will be useful,\n but WITHOUT ANY WARRANTY; without even the implied warranty of\n MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n GNU Lesser General Public License for more details.\n\n You should have received a copy of the GNU Lesser General Public License\n along with web3.js.  If not, see <http://www.gnu.org/licenses/>.\n */\n/**\n * @file MethodModelFactory.js\n * @author Samuel Furter <samuel@ethereum.org>\n * @date 2018\n */\n\nimport {\n    AbstractMethodModelFactory,\n    ShhVersionMethodModel,\n    GetInfoMethodModel,\n    SetMaxMessageSizeMethodModel,\n    SetMinPoWMethodModel,\n    MarkTrustedPeerMethodModel,\n    NewKeyPairMethodModel,\n    AddPrivateKeyMethodModel,\n    DeleteKeyPairMethodModel,\n    HasKeyPairMethodModel,\n    GetPublicKeyMethodModel,\n    GetPrivateKeyMethodModel,\n    NewSymKeyMethodModel,\n    AddSymKeyMethodModel,\n    GenerateSymKeyFromPasswordMethodModel,\n    HasSymKeyMethodModel,\n    GetSymKeyMethodModel,\n    DeleteSymKeyMethodModel,\n    NewMessageFilterMethodModel,\n    GetFilterMessagesMethodModel,\n    DeleteMessageFilterMethodModel,\n    PostMethodModel\n} from 'web3-core-method';\n\nexport default class MethodModelFactory extends AbstractMethodModelFactory {\n    /**\n     * @param {Object} utils\n     * @param {Object} formatters\n     *\n     * @constructor\n     */\n    constructor(utils, formatters) {\n        super(\n            {\n                getVersion: ShhVersionMethodModel,\n                getInfo: GetInfoMethodModel,\n                setMaxMessageSize: SetMaxMessageSizeMethodModel,\n                setMinPoW: SetMinPoWMethodModel,\n                markTrustedPeer: MarkTrustedPeerMethodModel,\n                newKeyPair: NewKeyPairMethodModel,\n                addPrivateKey: AddPrivateKeyMethodModel,\n                deleteKeyPair: DeleteKeyPairMethodModel,\n                hasKeyPair: HasKeyPairMethodModel,\n                getPublicKey: GetPublicKeyMethodModel,\n                getPrivateKey: GetPrivateKeyMethodModel,\n                newSymKey: NewSymKeyMethodModel,\n                addSymKey: AddSymKeyMethodModel,\n                generateSymKeyFromPassword: GenerateSymKeyFromPasswordMethodModel,\n                hasSymKey: HasSymKeyMethodModel,\n                getSymKey: GetSymKeyMethodModel,\n                deleteSymKey: DeleteSymKeyMethodModel,\n                newMessageFilter: NewMessageFilterMethodModel,\n                getFilterMessages: GetFilterMessagesMethodModel,\n                deleteMessageFilter: DeleteMessageFilterMethodModel,\n                post: PostMethodModel\n            },\n            utils,\n            formatters\n        );\n    }\n}\n","/*\n This file is part of web3.js.\n\n web3.js is free software: you can redistribute it and/or modify\n it under the terms of the GNU Lesser General Public License as published by\n the Free Software Foundation, either version 3 of the License, or\n (at your option) any later version.\n\n web3.js is distributed in the hope that it will be useful,\n but WITHOUT ANY WARRANTY; without even the implied warranty of\n MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n GNU Lesser General Public License for more details.\n\n You should have received a copy of the GNU Lesser General Public License\n along with web3.js.  If not, see <http://www.gnu.org/licenses/>.\n */\n/**\n * @file MethodModelFactory.js\n * @author Samuel Furter <samuel@ethereum.org>\n * @date 2018\n */\n\nimport Shh from '../Shh';\nimport MethodModelFactory from './MethodModelFactory';\n\nexport default class ShhModuleFactory {\n    /**\n     * @param {Object} utils\n     * @param {Object} formatters\n     *\n     * @constructor\n     */\n    constructor(utils, formatters) {\n        this.utils = utils;\n        this.formatters = formatters;\n    }\n\n    /**\n     * Returns an object of type Shh\n     *\n     * @method createShhModule\n     *\n     * @param {AbstractProviderAdapter} provider\n     * @param {ProvidersModuleFactory} providersModuleFactory\n     * @param {Object} providers\n     * @param {MethodController} methodController\n     * @param {SubscriptionsFactory} subscriptionsFactory\n     * @param {Network} net\n     * @param {Object} options\n     *\n     * @returns {Shh}\n     */\n    createShhModule(provider, providersModuleFactory, providers, methodController, subscriptionsFactory, net, options) {\n        return new Shh(\n            provider,\n            providersModuleFactory,\n            providers,\n            methodController,\n            this.createMethodModelFactory(),\n            subscriptionsFactory,\n            net,\n            options\n        );\n    }\n\n    /**\n     * Returns an object of type MethodModelFactory\n     *\n     * @method createMethodModelFactory\n     *\n     * @returns {MethodModelFactory}\n     */\n    createMethodModelFactory() {\n        return new MethodModelFactory(this.utils, this.formatters);\n    }\n}\n","/*\n    This file is part of web3.js.\n\n    web3.js is free software: you can redistribute it and/or modify\n    it under the terms of the GNU Lesser General Public License as published by\n    the Free Software Foundation, either version 3 of the License, or\n    (at your option) any later version.\n\n    web3.js is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU Lesser General Public License for more details.\n\n    You should have received a copy of the GNU Lesser General Public License\n    along with web3.js.  If not, see <http://www.gnu.org/licenses/>.\n*/\n/**\n * @file index.js\n * @author Samuel Furer <samuel@ethereum.org>\n * @date 2018\n */\n\nimport {ProvidersModuleFactory, providers} from 'web3-providers';\nimport {MethodController} from 'web3-core-method';\nimport {SubscriptionsFactory} from 'web3-core-subscriptions';\nimport {Network} from 'web3-net';\nimport * as Utils from 'web3-utils';\nimport {formatters} from 'web3-core-helpers';\nimport ShhModuleFactory from './factories/ShhModuleFactory';\n\n/**\n * Returns the Shh object.\n *\n * @method Shh\n *\n * @param {AbstractProviderAdapter|EthereumProvider} provider\n * @param {Object} options\n *\n * @returns {Shh}\n */\nexport const Shh = (provider, options) => {\n    return new ShhModuleFactory(Utils, formatters).createShhModule(\n        provider,\n        new ProvidersModuleFactory(),\n        providers,\n        new MethodController(),\n        new SubscriptionsFactory(),\n        new Network(provider, options),\n        options\n    );\n};\n"],"names":["Shh","AbstractWeb3Module","constructor","provider","providersModuleFactory","providers","methodController","methodModelFactory","subscriptionsFactory","net","options","subscribe","method","callback","createShhMessagesSubscription","Error","setProvider","defaultGasPrice","value","defaultGas","transactionBlockTimeout","transactionConfirmationBlocks","transactionPollingTimeout","defaultAccount","defaultBlock","MethodModelFactory","AbstractMethodModelFactory","utils","formatters","getVersion","ShhVersionMethodModel","getInfo","GetInfoMethodModel","setMaxMessageSize","SetMaxMessageSizeMethodModel","setMinPoW","SetMinPoWMethodModel","markTrustedPeer","MarkTrustedPeerMethodModel","newKeyPair","NewKeyPairMethodModel","addPrivateKey","AddPrivateKeyMethodModel","deleteKeyPair","DeleteKeyPairMethodModel","hasKeyPair","HasKeyPairMethodModel","getPublicKey","GetPublicKeyMethodModel","getPrivateKey","GetPrivateKeyMethodModel","newSymKey","NewSymKeyMethodModel","addSymKey","AddSymKeyMethodModel","generateSymKeyFromPassword","GenerateSymKeyFromPasswordMethodModel","hasSymKey","HasSymKeyMethodModel","getSymKey","GetSymKeyMethodModel","deleteSymKey","DeleteSymKeyMethodModel","newMessageFilter","NewMessageFilterMethodModel","getFilterMessages","GetFilterMessagesMethodModel","deleteMessageFilter","DeleteMessageFilterMethodModel","post","PostMethodModel","ShhModuleFactory","createShhModule","createMethodModelFactory","Utils","ProvidersModuleFactory","MethodController","SubscriptionsFactory","Network"],"mappings":"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"}