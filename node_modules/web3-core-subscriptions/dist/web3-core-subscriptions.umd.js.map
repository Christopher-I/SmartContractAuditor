{"version":3,"file":"web3-core-subscriptions.umd.js","sources":["../node_modules/underscore-es/_quickaccess.js","../node_modules/underscore-es/isArray.js","../node_modules/underscore-es/isFunction.js","../src/Subscription.js","../lib/models/AbstractSubscriptionModel.js","../src/models/subscriptions/eth/LogSubscriptionModel.js","../src/models/subscriptions/eth/NewHeadsSubscriptionModel.js","../src/models/subscriptions/eth/NewPendingTransactionsSubscriptionModel.js","../src/models/subscriptions/eth/SyncingSubscriptionModel.js","../src/models/subscriptions/shh/MessagesSubscriptionModel.js","../src/factories/SubscriptionsFactory.js","../src/factories/SubscriptionsModuleFactory.js","../src/index.js"],"sourcesContent":["// quick reference variables for speed access\n//-------------------------------------------\n\n// Save bytes in the minified (but not gzipped) version:\nexport const ArrayProto = Array.prototype;\nexport const ObjProto = Object.prototype;\nexport const SymbolProto = typeof Symbol !== 'undefined' ? Symbol.prototype : null;\n\n// Create quick reference variables for speed access to core prototypes.\nexport const push = ArrayProto.push;\nexport const slice = ArrayProto.slice;\nexport const toString = ObjProto.toString;\nexport const hasOwnProperty = ObjProto.hasOwnProperty;\n\n// All **ECMAScript 5** native function implementations that we hope to use\n// are declared here.\nexport const nativeIsArray = Array.isArray;\nexport const nativeKeys = Object.keys;\nexport const nativeCreate = Object.create;\n\n// Naked function reference for surrogate-prototype-swapping.\nexport const Ctor = function () {};","// `_isArray` : an object's function\n// ----------------------------------\n\nimport {nativeIsArray, toString} from './_quickaccess';\n\n// Is a given value an array?\n// Delegates to ECMA5's native Array.isArray\nexport var _isArray = nativeIsArray || function (obj) {\n\treturn toString.call(obj) === '[object Array]';\n}\n\nexport {_isArray as default};","// `_isFunction` : an object's function\n// -------------------------------------\n\nimport {toString} from './_quickaccess';\n\n// Optimize `isFunction` if appropriate. Work around some typeof bugs in old v8,\n// IE 11 (#1621), Safari 8 (#1929), and PhantomJS (#2236).\nfunction customFunction() {\n\tif (typeof /./ != 'function' && typeof Int8Array != 'object' && typeof document !== 'undefined' && typeof document.childNodes != 'function') {\n\t\treturn (obj) => typeof obj == 'function' || false;\n\t}\n\treturn null;\n}\n\n// Is a given value a function?\nvar _isFunction = customFunction() || function (obj) {\n\treturn toString.call(obj) === '[object Function]';\n}\n\nexport {_isFunction as default};","/*\n    This file is part of web3.js.\n\n    web3.js is free software: you can redistribute it and/or modify\n    it under the terms of the GNU Lesser General Public License as published by\n    the Free Software Foundation, either version 3 of the License, or\n    (at your option) any later version.\n\n    web3.js is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU Lesser General Public License for more details.\n\n    You should have received a copy of the GNU Lesser General Public License\n    along with web3.js.  If not, see <http://www.gnu.org/licenses/>.\n*/\n/**\n * @file Subscription.js\n * @authors: Samuel Furter <samuel@ethereum.org>\n * @date 2018\n */\n\nimport isArray from 'underscore-es/isArray';\nimport isFunction from 'underscore-es/isFunction';\nimport EventEmitter from 'eventemitter3';\n\nexport default class Subscription extends EventEmitter {\n    /**\n     * @param {AbstractSubscriptionModel} subscriptionModel\n     * @param {AbstractWeb3Module} moduleInstance\n     *\n     * @constructor\n     */\n    constructor(subscriptionModel, moduleInstance) {\n        super();\n        this.subscriptionModel = subscriptionModel;\n        this.moduleInstance = moduleInstance;\n        this.subscriptionId = null;\n    }\n\n    /**\n     * Sends the JSON-RPC request, emits the required events and executes the callback method.\n     *\n     * @method subscribe\n     *\n     * @param {Function} callback\n     *\n     * @callback callback callback(error, result)\n     * @returns {Subscription} Subscription\n     */\n    subscribe(callback) {\n        this.subscriptionModel.beforeSubscription(this, this.moduleInstance, callback);\n\n        this.moduleInstance.currentProvider\n            .subscribe(this.subscriptionModel.subscriptionType, this.subscriptionModel.subscriptionMethod, [\n                this.subscriptionModel.options\n            ])\n            .then((subscriptionId) => {\n                this.subscriptionId = subscriptionId;\n\n                this.moduleInstance.currentProvider.on(this.subscriptionId, (error, response) => {\n                    if (!error) {\n                        this.handleSubscriptionResponse(response, callback);\n\n                        return;\n                    }\n\n                    if (self.moduleInstance.currentProvider.once) {\n                        this.reconnect(callback);\n                    }\n\n                    if (isFunction(callback)) {\n                        callback(error, null);\n                    }\n\n                    this.emit('error', error);\n                });\n            });\n\n        return this;\n    }\n\n    /**\n     * Iterates over each item in the response, formats the output, emits required events and\n     * executes the callback method.\n     *\n     * @method handleSubscriptionResponse\n     *\n     * @param {*} response\n     * @param {Function} callback\n     *\n     * @callback callback callback(error, result)\n     */\n    handleSubscriptionResponse(response, callback) {\n        if (!isArray(response)) {\n            response = [response];\n        }\n\n        response.forEach(function(item) {\n            const formattedOutput = this.subscriptionModel.onNewSubscriptionItem(this, item);\n\n            this.emit('data', formattedOutput);\n\n            if (isFunction(callback)) {\n                callback(false, formattedOutput);\n            }\n        });\n    }\n\n    /**\n     * TODO: The reconnecting handling should only be in the provider the subscription should not care about it.\n     * Reconnects provider and restarts subscription\n     *\n     * @method reconnect\n     *\n     * @param {Function} callback\n     *\n     * @callback callback callback(error, result)\n     */\n    reconnect(callback) {\n        const interval = setInterval(() => {\n            if (this.moduleInstance.currentProvider.reconnect) {\n                this.moduleInstance.currentProvider.reconnect();\n            }\n        }, 500);\n\n        this.moduleInstance.currentProvider.once('connect', () => {\n            clearInterval(interval);\n            this.unsubscribe()\n                .then(() => {\n                    this.subscribe(callback);\n                })\n                .catch((error) => {\n                    this.emit('error', error);\n\n                    if (isFunction(callback)) {\n                        callback(error, null);\n                    }\n                });\n        });\n    }\n\n    /**\n     * Unsubscribes subscription\n     *\n     * @method unsubscribe\n     *\n     * @param {Function} callback\n     *\n     * @callback callback callback(error, result)\n     * @returns {Promise<boolean>}\n     */\n    unsubscribe(callback) {\n        return this.moduleInstance.currentProvider\n            .unsubscribe(this.subscriptionId, this.subscriptionModel.subscriptionType)\n            .then((response) => {\n                this.removeAllListeners('data');\n                this.removeAllListeners('error');\n\n                if (!response) {\n                    this.subscriptionId = null;\n\n                    if (isFunction(callback)) {\n                        callback(true, false);\n                    }\n\n                    return true;\n                }\n\n                if (isFunction(callback)) {\n                    callback(false, true);\n                }\n\n                return false;\n            });\n    }\n}\n","/*\n    This file is part of web3.js.\n\n    web3.js is free software: you can redistribute it and/or modify\n    it under the terms of the GNU Lesser General Public License as published by\n    the Free Software Foundation, either version 3 of the License, or\n    (at your option) any later version.\n\n    web3.js is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU Lesser General Public License for more details.\n\n    You should have received a copy of the GNU Lesser General Public License\n    along with web3.js.  If not, see <http://www.gnu.org/licenses/>.\n*/\n/**\n * @file AbstractSubscriptionModel.js\n * @authors: Samuel Furter <samuel@ethereum.org>\n * @date 2018\n */\n\nexport default class AbstractSubscriptionModel {\n    /**\n     * @param {String} subscriptionType\n     * @param {String} subscriptionMethod\n     * @param {Object} options\n     * @param {Object} utils\n     * @param {Object} formatters\n     *\n     * @constructor\n     */\n    constructor(subscriptionType, subscriptionMethod, options, utils, formatters) {\n        this.subscriptionType = subscriptionType;\n        this.subscriptionMethod = subscriptionMethod;\n        this.options = options;\n        this.util = utils;\n        this.formatters = formatters;\n    }\n\n    /**\n     * This method will be executed before the subscription starts.\n     *\n     * @method beforeSubscription\n     *\n     * @param {Subscription} subscription\n     * @param {AbstractWeb3Module} moduleInstance\n     * @param {Function} callback\n     */\n    beforeSubscription(subscription, moduleInstance, callback) {}\n\n    /**\n     * This method will be executed on each new subscription item.\n     *\n     * @method onNewSubscriptionItem\n     *\n     * @param {Subscription} subscription\n     * @param {*} subscriptionItem\n     *\n     * @returns {*}\n     */\n    onNewSubscriptionItem(subscription, subscriptionItem) {\n        return subscriptionItem;\n    }\n}\n","/*\n    This file is part of web3.js.\n\n    web3.js is free software: you can redistribute it and/or modify\n    it under the terms of the GNU Lesser General Public License as published by\n    the Free Software Foundation, either version 3 of the License, or\n    (at your option) any later version.\n\n    web3.js is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU Lesser General Public License for more details.\n\n    You should have received a copy of the GNU Lesser General Public License\n    along with web3.js.  If not, see <http://www.gnu.org/licenses/>.\n*/\n/**\n * @file LogSubscriptionModel.js\n * @authors: Samuel Furter <samuel@ethereum.org>\n * @date 2018\n */\n\nimport AbstractSubscriptionModel from '../../../../lib/models/AbstractSubscriptionModel';\n\nexport default class LogSubscriptionModel extends AbstractSubscriptionModel {\n    /**\n     * @param {Object} options\n     * @param {Object} utils\n     * @param {Object} formatters\n     * @param {GetPastLogsMethodModel} getPastLogsMethodModel\n     * @param {MethodController} methodController\n     *\n     * @constructor\n     */\n    constructor(options, utils, formatters, getPastLogsMethodModel, methodController) {\n        super('eth_subscribe', 'logs', options, utils, formatters);\n        this.getPastLogsMethodModel = getPastLogsMethodModel;\n        this.methodController = methodController;\n    }\n\n    /**\n     * This method will be executed before the subscription starts.\n     *\n     * @method beforeSubscription\n     *\n     * @param {Subscription} subscription\n     * @param {AbstractWeb3Module} moduleInstance\n     * @param {Function} callback\n     */\n    beforeSubscription(subscription, moduleInstance, callback) {\n        this.options = this.formatters.inputLogFormatter(this.options);\n        this.getPastLogsMethodModel.parameters = [this.options];\n\n        this.methodController\n            .execute(this.getPastLogsMethodModel, moduleInstance.currentProvider, null, moduleInstance)\n            .then((logs) => {\n                logs.forEach((log) => {\n                    callback(false, log);\n                    subscription.emit('data', log);\n                });\n\n                delete this.options.fromBlock;\n            })\n            .catch((error) => {\n                subscription.emit('error', error);\n                callback(error, null);\n            });\n    }\n\n    /**\n     * This method will be executed on each new subscription item.\n     *\n     * @method onNewSubscriptionItem\n     *\n     * @param {Subscription} subscription\n     * @param {*} subscriptionItem\n     *\n     * @returns {Object}\n     */\n    onNewSubscriptionItem(subscription, subscriptionItem) {\n        return this.formatters.outputLogFormatter(subscriptionItem);\n    }\n}\n","/*\n    This file is part of web3.js.\n\n    web3.js is free software: you can redistribute it and/or modify\n    it under the terms of the GNU Lesser General Public License as published by\n    the Free Software Foundation, either version 3 of the License, or\n    (at your option) any later version.\n\n    web3.js is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU Lesser General Public License for more details.\n\n    You should have received a copy of the GNU Lesser General Public License\n    along with web3.js.  If not, see <http://www.gnu.org/licenses/>.\n*/\n/**\n * @file NewHeadsSubscriptionModel.js\n * @authors: Samuel Furter <samuel@ethereum.org>\n * @date 2018\n */\n\nimport AbstractSubscriptionModel from '../../../../lib/models/AbstractSubscriptionModel';\n\nexport default class NewHeadsSubscriptionModel extends AbstractSubscriptionModel {\n    /**\n     * @param {Object} utils\n     * @param {Object} formatters\n     *\n     * @constructor\n     */\n    constructor(utils, formatters) {\n        super('eth_subscribe', 'newHeads', null, utils, formatters);\n    }\n\n    /**\n     * This method will be executed on each new subscription item.\n     *\n     * @method onNewSubscriptionItem\n     *\n     * @param {Subscription} subscription\n     * @param {*} subscriptionItem\n     *\n     * @returns {Object}\n     */\n    onNewSubscriptionItem(subscription, subscriptionItem) {\n        return this.formatters.outputBlockFormatter(subscriptionItem);\n    }\n}\n","/*\n    This file is part of web3.js.\n\n    web3.js is free software: you can redistribute it and/or modify\n    it under the terms of the GNU Lesser General Public License as published by\n    the Free Software Foundation, either version 3 of the License, or\n    (at your option) any later version.\n\n    web3.js is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU Lesser General Public License for more details.\n\n    You should have received a copy of the GNU Lesser General Public License\n    along with web3.js.  If not, see <http://www.gnu.org/licenses/>.\n*/\n/**\n * @file NewHeadSubscriptionModel.js\n * @authors: Samuel Furter <samuel@ethereum.org>\n * @date 2018\n */\n\nimport AbstractSubscriptionModel from '../../../../lib/models/AbstractSubscriptionModel';\n\nexport default class NewPendingTransactionsSubscriptionModel extends AbstractSubscriptionModel {\n    /**\n     * @param {Object} utils\n     * @param {Object} formatters\n     *\n     * @constructor\n     */\n    constructor(utils, formatters) {\n        super('eth_subscribe', 'newPendingTransactions', null, utils, formatters);\n    }\n}\n","/*\n    This file is part of web3.js.\n\n    web3.js is free software: you can redistribute it and/or modify\n    it under the terms of the GNU Lesser General Public License as published by\n    the Free Software Foundation, either version 3 of the License, or\n    (at your option) any later version.\n\n    web3.js is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU Lesser General Public License for more details.\n\n    You should have received a copy of the GNU Lesser General Public License\n    along with web3.js.  If not, see <http://www.gnu.org/licenses/>.\n*/\n/**\n * @file SyncingSubscriptionModel.js\n * @authors: Samuel Furter <samuel@ethereum.org>\n * @date 2018\n */\n\nimport AbstractSubscriptionModel from '../../../../lib/models/AbstractSubscriptionModel';\n\nexport default class SyncingSubscriptionModel extends AbstractSubscriptionModel {\n    /**\n     * @param {Object} utils\n     * @param {Object} formatters\n     *\n     * @constructor\n     */\n    constructor(utils, formatters) {\n        super('eth_subscribe', 'syncing', null, utils, formatters);\n        this.isSyncing = null;\n    }\n\n    /**\n     * This method will be executed on each new subscription item.\n     *\n     * @method onNewSubscriptionItem\n     *\n     * @param {Subscription} subscription\n     * @param {*} subscriptionItem\n     *\n     * @returns {Object}\n     */\n    onNewSubscriptionItem(subscription, subscriptionItem) {\n        const isSyncing = subscriptionItem.result.syncing;\n\n        if (this.isSyncing === null) {\n            this.isSyncing = isSyncing;\n            subscription.emit('changed', this.isSyncing);\n        }\n\n        if (this.isSyncing === true && isSyncing === false) {\n            this.isSyncing = isSyncing;\n            subscription.emit('changed', this.isSyncing);\n        }\n\n        if (this.isSyncing === false && isSyncing === true) {\n            this.isSyncing = isSyncing;\n            subscription.emit('changed', this.isSyncing);\n        }\n\n        return this.formatters.outputSyncingFormatter(subscriptionItem);\n    }\n}\n","/*\n    This file is part of web3.js.\n\n    web3.js is free software: you can redistribute it and/or modify\n    it under the terms of the GNU Lesser General Public License as published by\n    the Free Software Foundation, either version 3 of the License, or\n    (at your option) any later version.\n\n    web3.js is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU Lesser General Public License for more details.\n\n    You should have received a copy of the GNU Lesser General Public License\n    along with web3.js.  If not, see <http://www.gnu.org/licenses/>.\n*/\n/**\n * @file MessagesSubscriptionModel.js\n * @authors: Samuel Furter <samuel@ethereum.org>\n * @date 2018\n */\n\nimport AbstractSubscriptionModel from '../../../../lib/models/AbstractSubscriptionModel';\n\nexport default class MessagesSubscriptionModel extends AbstractSubscriptionModel {\n    /**\n     * @param {Object} options\n     * @param {Object} utils\n     * @param {Object} formatters\n     *\n     * @constructor\n     */\n    constructor(options, utils, formatters) {\n        super('shh_subscribe', 'messages', options, utils, formatters);\n    }\n}\n","/*\n    This file is part of web3.js.\n\n    web3.js is free software: you can redistribute it and/or modify\n    it under the terms of the GNU Lesser General Public License as published by\n    the Free Software Foundation, either version 3 of the License, or\n    (at your option) any later version.\n\n    web3.js is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU Lesser General Public License for more details.\n\n    You should have received a copy of the GNU Lesser General Public License\n    along with web3.js.  If not, see <http://www.gnu.org/licenses/>.\n*/\n/**\n * @file SubscriptionsFactory.js\n * @authors: Samuel Furter <samuel@ethereum.org>\n * @date 2018\n */\n\nimport Subscription from '../Subscription';\nimport LogSubscriptionModel from '../models/subscriptions/eth/LogSubscriptionModel';\nimport NewHeadsSubscriptionModel from '../models/subscriptions/eth/NewHeadsSubscriptionModel';\nimport NewPendingTransactionsSubscriptionModel from '../models/subscriptions/eth/NewPendingTransactionsSubscriptionModel';\nimport SyncingSubscriptionModel from '../models/subscriptions/eth/SyncingSubscriptionModel';\nimport MessagesSubscriptionModel from '../models/subscriptions/shh/MessagesSubscriptionModel';\n\nexport default class SubscriptionsFactory {\n    /**\n     * @param {Object} utils\n     * @param {Object} formatters\n     *\n     * @constructor\n     */\n    constructor(utils, formatters) {\n        this.utils = utils;\n        this.formatters = formatters;\n    }\n\n    /**\n     * Returns an eth log subscription\n     *\n     * @method createLogSubscription\n     *\n     * @param {AbstractWeb3Module} moduleInstance\n     * @param {Object} options\n     * @param {GetPastLogsMethodModel} getPastLogsMethodModel\n     * @param {MethodController} methodController\n     *\n     * @returns {Subscription}\n     */\n    createLogSubscription(moduleInstance, options, getPastLogsMethodModel, methodController) {\n        return new Subscription(\n            new LogSubscriptionModel(options, this.utils, this.formatters, getPastLogsMethodModel, methodController),\n            moduleInstance\n        );\n    }\n\n    /**\n     * Returns an eth newHeads subscription\n     *\n     * @method createNewHeadsSubscription\n     *\n     * @param {AbstractWeb3Module} moduleInstance\n     *\n     * @returns {Subscription}\n     */\n    createNewHeadsSubscription(moduleInstance) {\n        return new Subscription(new NewHeadsSubscriptionModel(this.utils, this.formatters), moduleInstance);\n    }\n\n    /**\n     * Returns an eth newPendingTransactions subscription\n     *\n     * @method createNewPendingTransactionsSubscription\n     *\n     * @param {AbstractWeb3Module} moduleInstance\n     *\n     * @returns {Subscription}\n     */\n    createNewPendingTransactionsSubscription(moduleInstance) {\n        return new Subscription(\n            new NewPendingTransactionsSubscriptionModel(this.utils, this.formatters),\n            moduleInstance\n        );\n    }\n\n    /**\n     * Returns an eth syncing subscription\n     *\n     * @method createSyncingSubscriptionModel\n     *\n     * @param {AbstractWeb3Module} moduleInstance\n     *\n     * @returns {Subscription}\n     */\n    createSyncingSubscriptionModel(moduleInstance) {\n        return new Subscription(new SyncingSubscriptionModel(this.utils, this.formatters), moduleInstance);\n    }\n\n    /**\n     * Returns an shh messages subscription\n     *\n     * @method createShhMessagesSubscription\n     *\n     * @param {AbstractWeb3Module} moduleInstance\n     * @param {Object} options\n     *\n     * @returns {Subscription}\n     */\n    createShhMessagesSubscription(moduleInstance, options) {\n        return new Subscription(new MessagesSubscriptionModel(options, this.utils, this.formatters), moduleInstance);\n    }\n}\n","/*\n    This file is part of web3.js.\n\n    web3.js is free software: you can redistribute it and/or modify\n    it under the terms of the GNU Lesser General Public License as published by\n    the Free Software Foundation, either version 3 of the License, or\n    (at your option) any later version.\n\n    web3.js is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU Lesser General Public License for more details.\n\n    You should have received a copy of the GNU Lesser General Public License\n    along with web3.js.  If not, see <http://www.gnu.org/licenses/>.\n*/\n/**\n * @file SubscriptionsFactory.js\n * @authors: Samuel Furter <samuel@ethereum.org>\n * @date 2018\n */\n\nimport SubscriptionsFactory from './SubscriptionsFactory';\n\nexport default class SubscriptionsModuleFactory {\n    /**\n     * Returns an object of type SubscriptionsFactory\n     *\n     * @method createSubscriptionsFactory\n     *\n     * @param {Object} utils\n     * @param {Object} formatters\n     *\n     * @returns {SubscriptionsFactory}\n     */\n    createSubscriptionsFactory(utils, formatters) {\n        return new SubscriptionsFactory(utils, formatters);\n    }\n}\n","/*\n    This file is part of web3.js.\n\n    web3.js is free software: you can redistribute it and/or modify\n    it under the terms of the GNU Lesser General Public License as published by\n    the Free Software Foundation, either version 3 of the License, or\n    (at your option) any later version.\n\n    web3.js is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU Lesser General Public License for more details.\n\n    You should have received a copy of the GNU Lesser General Public License\n    along with web3.js.  If not, see <http://www.gnu.org/licenses/>.\n*/\n/**\n * @file index.js\n * @authors: Samuel Furter <samuel@ethereum.org>\n * @date 2018\n */\n\nimport * as Utils from 'web3-utils';\nimport {formatters} from 'web3-core-helpers';\nimport SubscriptionsModuleFactory from './factories/SubscriptionsModuleFactory';\n\n/**\n * Returns an object of type SubscriptionsFactory\n *\n * @method SubscriptionsFactory\n *\n * @returns {SubscriptionsFactory}\n */\nexport const SubscriptionsFactory = () => {\n    return new SubscriptionsModuleFactory().createSubscriptionsFactory(Utils, formatters);\n};\n\nexport LogSubscriptionModel from './models/subscriptions/eth/LogSubscriptionModel';\nexport Subscription from './Subscription';\n"],"names":["Subscription","EventEmitter","constructor","subscriptionModel","moduleInstance","subscriptionId","subscribe","callback","beforeSubscription","currentProvider","subscriptionType","subscriptionMethod","options","then","on","error","response","handleSubscriptionResponse","self","once","reconnect","isFunction","emit","isArray","forEach","item","formattedOutput","onNewSubscriptionItem","interval","setInterval","clearInterval","unsubscribe","catch","removeAllListeners","AbstractSubscriptionModel","utils","formatters","util","subscription","subscriptionItem","LogSubscriptionModel","getPastLogsMethodModel","methodController","inputLogFormatter","parameters","execute","logs","log","fromBlock","outputLogFormatter","NewHeadsSubscriptionModel","outputBlockFormatter","NewPendingTransactionsSubscriptionModel","SyncingSubscriptionModel","isSyncing","result","syncing","outputSyncingFormatter","MessagesSubscriptionModel","SubscriptionsFactory","createLogSubscription","createNewHeadsSubscription","createNewPendingTransactionsSubscription","createSyncingSubscriptionModel","createShhMessagesSubscription","SubscriptionsModuleFactory","createSubscriptionsFactory","Utils"],"mappings":";;;;;;;;CAAA;AACA,CAIO,MAAM,QAAQ,GAAG,MAAM,CAAC,SAAS,CAAC;AACzC,CAKO,MAAM,QAAQ,GAAG,QAAQ,CAAC,QAAQ,CAAC;AAC1C,AACA;CACA;CACA;AACA,CAAO,MAAM,aAAa,GAAG,KAAK,CAAC,OAAO,CAAC;;CChB3C;AACA,AAGA;CACA;CACA;AACA,CAAO,IAAI,QAAQ,GAAG,aAAa,IAAI,UAAU,GAAG,EAAE;CACtD,CAAC,OAAO,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,gBAAgB,CAAC;CAChD,CAAC;;CCTD;AACA,AAGA;CACA;CACA;CACA,SAAS,cAAc,GAAG;CAC1B,CAAC,IAAI,AAA4B,OAAO,SAAS,IAAI,QAAQ,IAAI,OAAO,QAAQ,KAAK,WAAW,IAAI,OAAO,QAAQ,CAAC,UAAU,IAAI,UAAU,EAAE;CAC9I,EAAE,OAAO,CAAC,GAAG,KAAK,OAAO,GAAG,IAAI,UAAU,IAAI,KAAK,CAAC;CACpD,EAAE;CACF,CAAC,OAAO,IAAI,CAAC;CACb,CAAC;;CAED;CACA,IAAI,WAAW,GAAG,cAAc,EAAE,IAAI,UAAU,GAAG,EAAE;CACrD,CAAC,OAAO,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,mBAAmB,CAAC;CACnD,CAAC;;CCjBD;;;;;;;;;;;;;;;;CA0Be,MAAMA,YAAN,SAA2BC,YAA3B,CAAwC;CACnD;;;;;;CAMAC,EAAAA,WAAW,CAACC,iBAAD,EAAoBC,cAApB,EAAoC;CAC3C;CACA,SAAKD,iBAAL,GAAyBA,iBAAzB;CACA,SAAKC,cAAL,GAAsBA,cAAtB;CACA,SAAKC,cAAL,GAAsB,IAAtB;CACH;CAED;;;;;;;;;;;;CAUAC,EAAAA,SAAS,CAACC,QAAD,EAAW;CAChB,SAAKJ,iBAAL,CAAuBK,kBAAvB,CAA0C,IAA1C,EAAgD,KAAKJ,cAArD,EAAqEG,QAArE;CAEA,SAAKH,cAAL,CAAoBK,eAApB,CACKH,SADL,CACe,KAAKH,iBAAL,CAAuBO,gBADtC,EACwD,KAAKP,iBAAL,CAAuBQ,kBAD/E,EACmG,CAC3F,KAAKR,iBAAL,CAAuBS,OADoE,CADnG,EAIKC,IAJL,CAIWR,cAAD,IAAoB;CACtB,WAAKA,cAAL,GAAsBA,cAAtB;CAEA,WAAKD,cAAL,CAAoBK,eAApB,CAAoCK,EAApC,CAAuC,KAAKT,cAA5C,EAA4D,CAACU,KAAD,EAAQC,QAAR,KAAqB;CAC7E,YAAI,CAACD,KAAL,EAAY;CACR,eAAKE,0BAAL,CAAgCD,QAAhC,EAA0CT,QAA1C;CAEA;CACH;;CAED,YAAIW,IAAI,CAACd,cAAL,CAAoBK,eAApB,CAAoCU,IAAxC,EAA8C;CAC1C,eAAKC,SAAL,CAAeb,QAAf;CACH;;CAED,YAAIc,WAAU,CAACd,QAAD,CAAd,EAA0B;CACtBA,UAAAA,QAAQ,CAACQ,KAAD,EAAQ,IAAR,CAAR;CACH;;CAED,aAAKO,IAAL,CAAU,OAAV,EAAmBP,KAAnB;CACH,OAhBD;CAiBH,KAxBL;CA0BA,WAAO,IAAP;CACH;CAED;;;;;;;;;;;;;CAWAE,EAAAA,0BAA0B,CAACD,QAAD,EAAWT,QAAX,EAAqB;CAC3C,QAAI,CAACgB,QAAO,CAACP,QAAD,CAAZ,EAAwB;CACpBA,MAAAA,QAAQ,GAAG,CAACA,QAAD,CAAX;CACH;;CAEDA,IAAAA,QAAQ,CAACQ,OAAT,CAAiB,UAASC,IAAT,EAAe;CAC5B,YAAMC,eAAe,GAAG,KAAKvB,iBAAL,CAAuBwB,qBAAvB,CAA6C,IAA7C,EAAmDF,IAAnD,CAAxB;CAEA,WAAKH,IAAL,CAAU,MAAV,EAAkBI,eAAlB;;CAEA,UAAIL,WAAU,CAACd,QAAD,CAAd,EAA0B;CACtBA,QAAAA,QAAQ,CAAC,KAAD,EAAQmB,eAAR,CAAR;CACH;CACJ,KARD;CASH;CAED;;;;;;;;;;;;CAUAN,EAAAA,SAAS,CAACb,QAAD,EAAW;CAChB,UAAMqB,QAAQ,GAAGC,WAAW,CAAC,MAAM;CAC/B,UAAI,KAAKzB,cAAL,CAAoBK,eAApB,CAAoCW,SAAxC,EAAmD;CAC/C,aAAKhB,cAAL,CAAoBK,eAApB,CAAoCW,SAApC;CACH;CACJ,KAJ2B,EAIzB,GAJyB,CAA5B;CAMA,SAAKhB,cAAL,CAAoBK,eAApB,CAAoCU,IAApC,CAAyC,SAAzC,EAAoD,MAAM;CACtDW,MAAAA,aAAa,CAACF,QAAD,CAAb;CACA,WAAKG,WAAL,GACKlB,IADL,CACU,MAAM;CACR,aAAKP,SAAL,CAAeC,QAAf;CACH,OAHL,EAIKyB,KAJL,CAIYjB,KAAD,IAAW;CACd,aAAKO,IAAL,CAAU,OAAV,EAAmBP,KAAnB;;CAEA,YAAIM,WAAU,CAACd,QAAD,CAAd,EAA0B;CACtBA,UAAAA,QAAQ,CAACQ,KAAD,EAAQ,IAAR,CAAR;CACH;CACJ,OAVL;CAWH,KAbD;CAcH;CAED;;;;;;;;;;;;CAUAgB,EAAAA,WAAW,CAACxB,QAAD,EAAW;CAClB,WAAO,KAAKH,cAAL,CAAoBK,eAApB,CACFsB,WADE,CACU,KAAK1B,cADf,EAC+B,KAAKF,iBAAL,CAAuBO,gBADtD,EAEFG,IAFE,CAEIG,QAAD,IAAc;CAChB,WAAKiB,kBAAL,CAAwB,MAAxB;CACA,WAAKA,kBAAL,CAAwB,OAAxB;;CAEA,UAAI,CAACjB,QAAL,EAAe;CACX,aAAKX,cAAL,GAAsB,IAAtB;;CAEA,YAAIgB,WAAU,CAACd,QAAD,CAAd,EAA0B;CACtBA,UAAAA,QAAQ,CAAC,IAAD,EAAO,KAAP,CAAR;CACH;;CAED,eAAO,IAAP;CACH;;CAED,UAAIc,WAAU,CAACd,QAAD,CAAd,EAA0B;CACtBA,QAAAA,QAAQ,CAAC,KAAD,EAAQ,IAAR,CAAR;CACH;;CAED,aAAO,KAAP;CACH,KArBE,CAAP;CAsBH;;CArJkD;;CC1BvD;;;;;;;;;;;;;;;;;CAgBA;;;;;AAMA,CAAe,MAAM2B,yBAAN,CAAgC;CAC3C;;;;;;;;;CASAhC,EAAAA,WAAW,CAACQ,gBAAD,EAAmBC,kBAAnB,EAAuCC,OAAvC,EAAgDuB,KAAhD,EAAuDC,UAAvD,EAAmE;CAC1E,SAAK1B,gBAAL,GAAwBA,gBAAxB;CACA,SAAKC,kBAAL,GAA0BA,kBAA1B;CACA,SAAKC,OAAL,GAAeA,OAAf;CACA,SAAKyB,IAAL,GAAYF,KAAZ;CACA,SAAKC,UAAL,GAAkBA,UAAlB;CACH;CAED;;;;;;;;;;;CASA5B,EAAAA,kBAAkB,CAAC8B,YAAD,EAAelC,cAAf,EAA+BG,QAA/B,EAAyC;CAE3D;;;;;;;;;;;;CAUAoB,EAAAA,qBAAqB,CAACW,YAAD,EAAeC,gBAAf,EAAiC;CAClD,WAAOA,gBAAP;CACH;;CAzC0C;;CCtB/C;;;;;;;;;;;;;;;;CAwBe,MAAMC,oBAAN,SAAmCN,yBAAnC,CAA6D;CACxE;;;;;;;;;CASAhC,EAAAA,WAAW,CAACU,OAAD,EAAUuB,KAAV,EAAiBC,UAAjB,EAA6BK,sBAA7B,EAAqDC,gBAArD,EAAuE;CAC9E,UAAM,eAAN,EAAuB,MAAvB,EAA+B9B,OAA/B,EAAwCuB,KAAxC,EAA+CC,UAA/C;CACA,SAAKK,sBAAL,GAA8BA,sBAA9B;CACA,SAAKC,gBAAL,GAAwBA,gBAAxB;CACH;CAED;;;;;;;;;;;CASAlC,EAAAA,kBAAkB,CAAC8B,YAAD,EAAelC,cAAf,EAA+BG,QAA/B,EAAyC;CACvD,SAAKK,OAAL,GAAe,KAAKwB,UAAL,CAAgBO,iBAAhB,CAAkC,KAAK/B,OAAvC,CAAf;CACA,SAAK6B,sBAAL,CAA4BG,UAA5B,GAAyC,CAAC,KAAKhC,OAAN,CAAzC;CAEA,SAAK8B,gBAAL,CACKG,OADL,CACa,KAAKJ,sBADlB,EAC0CrC,cAAc,CAACK,eADzD,EAC0E,IAD1E,EACgFL,cADhF,EAEKS,IAFL,CAEWiC,IAAD,IAAU;CACZA,MAAAA,IAAI,CAACtB,OAAL,CAAcuB,GAAD,IAAS;CAClBxC,QAAAA,QAAQ,CAAC,KAAD,EAAQwC,GAAR,CAAR;CACAT,QAAAA,YAAY,CAAChB,IAAb,CAAkB,MAAlB,EAA0ByB,GAA1B;CACH,OAHD;CAKA,aAAO,KAAKnC,OAAL,CAAaoC,SAApB;CACH,KATL,EAUKhB,KAVL,CAUYjB,KAAD,IAAW;CACduB,MAAAA,YAAY,CAAChB,IAAb,CAAkB,OAAlB,EAA2BP,KAA3B;CACAR,MAAAA,QAAQ,CAACQ,KAAD,EAAQ,IAAR,CAAR;CACH,KAbL;CAcH;CAED;;;;;;;;;;;;CAUAY,EAAAA,qBAAqB,CAACW,YAAD,EAAeC,gBAAf,EAAiC;CAClD,WAAO,KAAKH,UAAL,CAAgBa,kBAAhB,CAAmCV,gBAAnC,CAAP;CACH;;CAzDuE;;CCxB5E;;;;;;;;;;;;;;;;CAwBe,MAAMW,yBAAN,SAAwChB,yBAAxC,CAAkE;CAC7E;;;;;;CAMAhC,EAAAA,WAAW,CAACiC,KAAD,EAAQC,UAAR,EAAoB;CAC3B,UAAM,eAAN,EAAuB,UAAvB,EAAmC,IAAnC,EAAyCD,KAAzC,EAAgDC,UAAhD;CACH;CAED;;;;;;;;;;;;CAUAT,EAAAA,qBAAqB,CAACW,YAAD,EAAeC,gBAAf,EAAiC;CAClD,WAAO,KAAKH,UAAL,CAAgBe,oBAAhB,CAAqCZ,gBAArC,CAAP;CACH;;CAvB4E;;CCxBjF;;;;;;;;;;;;;;;;CAwBe,MAAMa,uCAAN,SAAsDlB,yBAAtD,CAAgF;CAC3F;;;;;;CAMAhC,EAAAA,WAAW,CAACiC,KAAD,EAAQC,UAAR,EAAoB;CAC3B,UAAM,eAAN,EAAuB,wBAAvB,EAAiD,IAAjD,EAAuDD,KAAvD,EAA8DC,UAA9D;CACH;;CAT0F;;CCxB/F;;;;;;;;;;;;;;;;CAwBe,MAAMiB,wBAAN,SAAuCnB,yBAAvC,CAAiE;CAC5E;;;;;;CAMAhC,EAAAA,WAAW,CAACiC,KAAD,EAAQC,UAAR,EAAoB;CAC3B,UAAM,eAAN,EAAuB,SAAvB,EAAkC,IAAlC,EAAwCD,KAAxC,EAA+CC,UAA/C;CACA,SAAKkB,SAAL,GAAiB,IAAjB;CACH;CAED;;;;;;;;;;;;CAUA3B,EAAAA,qBAAqB,CAACW,YAAD,EAAeC,gBAAf,EAAiC;CAClD,UAAMe,SAAS,GAAGf,gBAAgB,CAACgB,MAAjB,CAAwBC,OAA1C;;CAEA,QAAI,KAAKF,SAAL,KAAmB,IAAvB,EAA6B;CACzB,WAAKA,SAAL,GAAiBA,SAAjB;CACAhB,MAAAA,YAAY,CAAChB,IAAb,CAAkB,SAAlB,EAA6B,KAAKgC,SAAlC;CACH;;CAED,QAAI,KAAKA,SAAL,KAAmB,IAAnB,IAA2BA,SAAS,KAAK,KAA7C,EAAoD;CAChD,WAAKA,SAAL,GAAiBA,SAAjB;CACAhB,MAAAA,YAAY,CAAChB,IAAb,CAAkB,SAAlB,EAA6B,KAAKgC,SAAlC;CACH;;CAED,QAAI,KAAKA,SAAL,KAAmB,KAAnB,IAA4BA,SAAS,KAAK,IAA9C,EAAoD;CAChD,WAAKA,SAAL,GAAiBA,SAAjB;CACAhB,MAAAA,YAAY,CAAChB,IAAb,CAAkB,SAAlB,EAA6B,KAAKgC,SAAlC;CACH;;CAED,WAAO,KAAKlB,UAAL,CAAgBqB,sBAAhB,CAAuClB,gBAAvC,CAAP;CACH;;CAzC2E;;CCxBhF;;;;;;;;;;;;;;;;CAwBe,MAAMmB,yBAAN,SAAwCxB,yBAAxC,CAAkE;CAC7E;;;;;;;CAOAhC,EAAAA,WAAW,CAACU,OAAD,EAAUuB,KAAV,EAAiBC,UAAjB,EAA6B;CACpC,UAAM,eAAN,EAAuB,UAAvB,EAAmCxB,OAAnC,EAA4CuB,KAA5C,EAAmDC,UAAnD;CACH;;CAV4E;;CCxBjF;;;;;;;;;;;;;;;;CA6Be,MAAMuB,oBAAN,CAA2B;CACtC;;;;;;CAMAzD,EAAAA,WAAW,CAACiC,KAAD,EAAQC,UAAR,EAAoB;CAC3B,SAAKD,KAAL,GAAaA,KAAb;CACA,SAAKC,UAAL,GAAkBA,UAAlB;CACH;CAED;;;;;;;;;;;;;;CAYAwB,EAAAA,qBAAqB,CAACxD,cAAD,EAAiBQ,OAAjB,EAA0B6B,sBAA1B,EAAkDC,gBAAlD,EAAoE;CACrF,WAAO,IAAI1C,YAAJ,CACH,IAAIwC,oBAAJ,CAAyB5B,OAAzB,EAAkC,KAAKuB,KAAvC,EAA8C,KAAKC,UAAnD,EAA+DK,sBAA/D,EAAuFC,gBAAvF,CADG,EAEHtC,cAFG,CAAP;CAIH;CAED;;;;;;;;;;;CASAyD,EAAAA,0BAA0B,CAACzD,cAAD,EAAiB;CACvC,WAAO,IAAIJ,YAAJ,CAAiB,IAAIkD,yBAAJ,CAA8B,KAAKf,KAAnC,EAA0C,KAAKC,UAA/C,CAAjB,EAA6EhC,cAA7E,CAAP;CACH;CAED;;;;;;;;;;;CASA0D,EAAAA,wCAAwC,CAAC1D,cAAD,EAAiB;CACrD,WAAO,IAAIJ,YAAJ,CACH,IAAIoD,uCAAJ,CAA4C,KAAKjB,KAAjD,EAAwD,KAAKC,UAA7D,CADG,EAEHhC,cAFG,CAAP;CAIH;CAED;;;;;;;;;;;CASA2D,EAAAA,8BAA8B,CAAC3D,cAAD,EAAiB;CAC3C,WAAO,IAAIJ,YAAJ,CAAiB,IAAIqD,wBAAJ,CAA6B,KAAKlB,KAAlC,EAAyC,KAAKC,UAA9C,CAAjB,EAA4EhC,cAA5E,CAAP;CACH;CAED;;;;;;;;;;;;CAUA4D,EAAAA,6BAA6B,CAAC5D,cAAD,EAAiBQ,OAAjB,EAA0B;CACnD,WAAO,IAAIZ,YAAJ,CAAiB,IAAI0D,yBAAJ,CAA8B9C,OAA9B,EAAuC,KAAKuB,KAA5C,EAAmD,KAAKC,UAAxD,CAAjB,EAAsFhC,cAAtF,CAAP;CACH;;CArFqC;;CC7B1C;;;;;;;;;;;;;;;;CAwBe,MAAM6D,0BAAN,CAAiC;CAC5C;;;;;;;;;;CAUAC,EAAAA,0BAA0B,CAAC/B,KAAD,EAAQC,UAAR,EAAoB;CAC1C,WAAO,IAAIuB,oBAAJ,CAAyBxB,KAAzB,EAAgCC,UAAhC,CAAP;CACH;;CAb2C;;CCxBhD;;;;;;;;;;;;;;;;CA0BA;;;;;;;;AAOA,OAAauB,sBAAoB,GAAG,MAAM;CACtC,SAAO,IAAIM,0BAAJ,GAAiCC,0BAAjC,CAA4DC,KAA5D,EAAmE/B,0BAAnE,CAAP;CACH,CAFM;;;;;;;;;;;;;;"}