<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for contracts/OceanBounty.sol</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../prettify.css" />
    <link rel="stylesheet" href="../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../index.html">all files</a> / <a href="index.html">contracts/</a> OceanBounty.sol
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">98.81% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>83/84</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">72.22% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>26/36</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">100% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>11/11</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">98% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>98/100</span>
      </div>
    </div>
  </div>
  <div class='status-line high'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">29×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">29×</span>
<span class="cline-any cline-yes">29×</span>
<span class="cline-any cline-yes">29×</span>
<span class="cline-any cline-yes">29×</span>
<span class="cline-any cline-yes">29×</span>
<span class="cline-any cline-yes">29×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">29×</span>
<span class="cline-any cline-yes">29×</span>
<span class="cline-any cline-yes">29×</span>
<span class="cline-any cline-yes">29×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">29×</span>
<span class="cline-any cline-yes">29×</span>
<span class="cline-any cline-yes">29×</span>
<span class="cline-any cline-yes">29×</span>
<span class="cline-any cline-yes">29×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">29×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">180×</span>
<span class="cline-any cline-yes">180×</span>
<span class="cline-any cline-yes">180×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">51×</span>
<span class="cline-any cline-yes">51×</span>
<span class="cline-any cline-yes">51×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">51×</span>
<span class="cline-any cline-yes">51×</span>
<span class="cline-any cline-yes">51×</span>
<span class="cline-any cline-yes">51×</span>
<span class="cline-any cline-yes">49×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">49×</span>
<span class="cline-any cline-yes">49×</span>
<span class="cline-any cline-yes">49×</span>
<span class="cline-any cline-yes">49×</span>
<span class="cline-any cline-yes">49×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">49×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">78×</span>
<span class="cline-any cline-yes">78×</span>
<span class="cline-any cline-yes">78×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">49×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">49×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">78×</span>
<span class="cline-any cline-yes">78×</span>
<span class="cline-any cline-yes">57×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">21×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">49×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">49×</span>
<span class="cline-any cline-yes">28×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">21×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">80×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">80×</span>
<span class="cline-any cline-yes">66×</span>
<span class="cline-any cline-yes">66×</span>
<span class="cline-any cline-yes">66×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">14×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">14×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">49×</span>
<span class="cline-any cline-yes">49×</span>
<span class="cline-any cline-yes">49×</span>
<span class="cline-any cline-yes">49×</span>
<span class="cline-any cline-yes">49×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">49×</span>
<span class="cline-any cline-yes">21×</span>
<span class="cline-any cline-yes">21×</span>
<span class="cline-any cline-yes">25×</span>
<span class="cline-any cline-yes">25×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">21×</span>
<span class="cline-any cline-yes">21×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">28×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">28×</span>
<span class="cline-any cline-yes">52×</span>
<span class="cline-any cline-yes">52×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">28×</span>
<span class="cline-any cline-yes">28×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">pragma solidity ^0.5.0;
&nbsp;
import "../others/Ownable.sol";
import "../others/SafeMath.sol";
&nbsp;
contract OceanBounty is Ownable {
&nbsp;
    //@dev use of safemath
    using SafeMath for uint256;
&nbsp;
&nbsp;
    
    // @dev constants
    int8 constant public WhitelistThreshold = 5;  
    int8 constant public BlacklistThreshold = -5; 
    int8 constant public PunishmentMultiplier = 5; 
    uint256 public noOfTracks; 
&nbsp;
    
    // @notice enums  
    enum TrackState { SANDBOX, WHITELIST, BLACKLIST} 
    enum TrackGenre {JAZZ, BLUES, ROCKNROLL, COUNTRY}    
    event VoteSuccessful (address userAddress, int8 trackgenre, int voteValue, int8 noOfVotesToday);
    event TrackCreationSuccessful (uint trackhash, address userAddress, int8 trackgenre, uint voteValue);  
    
    // @notice structs 
    struct Track  {      
        int8 trackGenre;  
        int16 trackRating; 
        uint hash ;  
        TrackState trackState; 
        address [] vouches; 
        address [] rejects; 
        mapping(address =&gt; bool) userDidVote;
    }
    
   // @notice details of each user and their history 
    struct User{
        int8 noOfVotesInDay;  
        uint256 vouchCredits; 
        uint256 rejectCredits; 
        address userAddress;        
    }
&nbsp;
   // @notice details of each genre 
    struct Genre{
        int8 totalVotes; 
        int8 averageScore; 
    }
&nbsp;
    // @notice mappings
    // @notice mapping of all genre types and their scores
    // @notice mapping storage of all tracks
    // @notice mapping storage of all users
    // @notice playlist mapping track hash to track
    // @notice mapping to keep track if user ids in relation to their expiry time
    mapping (int8 =&gt; Genre) public genreRegistry; 
    mapping (uint =&gt; Track) public trackRegistry; 
    mapping (address =&gt; User) public userRegistry; 
    mapping (uint =&gt; Track) public playlist;  
    mapping (address =&gt; uint) public timeOfVoteExpiry;
&nbsp;
    // @notice ensure trackhash input is not 0
    // @notice check if track has been created already
    // @notice ensure genre input is valid
    // @dev automatic vouch for track creation
    function proposeTrack(uint trackHash, int8 trackGenre)public{ 
        int8 maxNumberOfGenres = 3;
&nbsp;
        
        <span class="missing-if-branch" title="else path not taken" >E</span>require(trackHash != 0, 'please check track hash is not 0 and retry'); 
        <span class="missing-if-branch" title="else path not taken" >E</span>require(trackRegistry[trackHash].hash == 0, 'this track hash has been used already please try again'); 
        <span class="missing-if-branch" title="else path not taken" >E</span>require(trackGenre &lt;= maxNumberOfGenres, 'please entere a valid genre number between 0 and 2'); //
        Track memory track ;  
        track.hash = trackHash;  
        track.trackGenre = trackGenre; 
&nbsp;
        User memory user; 
        user.userAddress = msg.sender;  
        user.vouchCredits = 1; //
        userRegistry[msg.sender] = user;
        
        trackRegistry[trackHash] = track;
        updateuserAddressToVote(trackHash, 1,msg.sender); 
        noOfTracks = noOfTracks.add(1); 
        updateGenre(trackGenre); 
        updateNumberOfVotesPerDay(msg.sender);  
&nbsp;
        emit TrackCreationSuccessful(trackHash, msg.sender,trackGenre, 1);  
    }
&nbsp;
&nbsp;
    // @notice this function is used to create new users, which are neccesary to place votes
    // @notice function create temporary instance of a new user 
    // @notice define userAddress
    // @notice store user information in registry 
    function createNewUser()public{ 
        User memory newUser; 
        newUser.userAddress = msg.sender; 
        userRegistry[msg.sender] = newUser;       
    }    
    
    
    // @notice this function vouches or rejects the given track based on user vote 
    // @notice create a temporary address instance for userAddress, this is declared this way so that the user ID can always be easily changed to a different type
    // @notice retrieve track information from storage
    // @notice ensure user is registered
    // @notice ensure track is not BLACKLISTed
    // @notice check if user has previously voted for this track
    // @notice check if user has votes more than 10 times in a day
    // @dev require didvouch param to be either equal to -1 or 1 to avoid excessive lines of code.(-1 = reject, 1= vouch). This code line can easliy be updated in future to allow more voting options
&nbsp;
    function vouchOrReject(uint trackHash, int8 didVouch)public {        
        address userAddress = msg.sender; //
        Track storage track = trackRegistry[trackHash];
        uint8 enumBlacklistValue = 2;
&nbsp;
        <span class="missing-if-branch" title="else path not taken" >E</span>require(userRegistry[userAddress].userAddress != address(0),'user information is not in registry, please create new user'); 
        <span class="missing-if-branch" title="else path not taken" >E</span>require(uint8(trackRegistry[trackHash].trackState) != enumBlacklistValue, 'selected track is BLACKLISTed');
        <span class="missing-if-branch" title="else path not taken" >E</span>require(!track.userDidVote[userAddress], 'you have already voted on this track'); 
        require(updateNumberOfVotesPerDay(userAddress),'you have exceeded your number of votes for today, please try after 24hrs');
        <span class="missing-if-branch" title="else path not taken" >E</span>require((didVouch == -1 || didVouch == 1 ), 'ensure that didvouch paramater is either -1 or 1'); 
        
        updateTrackRating(trackHash,didVouch);
        updateTrackState(trackHash,track.trackGenre); 
        updateCredits(trackHash,didVouch,userAddress);
        updateGenre(track.trackGenre); 
        track.userDidVote[userAddress] = true; 
        
        emit VoteSuccessful(userAddress,track.trackGenre, didVouch, userRegistry[userAddress].noOfVotesInDay); 
    }
&nbsp;
&nbsp;
    // @notice function to updated genre registry and information
    // @notice retrieve genre information from registry
    // @notice increment genre score
    // @notice update average score
    function updateGenre(int8 trackGenre)internal {
        Genre storage _genre = genreRegistry[trackGenre];
        _genre.totalVotes +=1;
        _genre.averageScore = int8(uint256(_genre.totalVotes).div(noOfTracks)); 
        }
&nbsp;
    
    // @notice internal function to update the TrackState of each track and user based on specified mechanics
    // @notice retrieve track information from registry
    // @notice check if WHITELISTing mechanics are met
    // @notice update TrackState to WHITELIST
    // @notice if WHITELISTed, save track to playlist
    // @notice check if BLACKLISTing mechanics are met
    // @notice update TrackState to BLACKLIST
    // @notice call function to penalize vouches for BLACKLISTed tracks
    // @notice if BLACKLISTed, then remove from registry
    // @notice if BLACKLISTed, delet from playlist
    // @noticereduce number of track count
    // @notice if non of the conditions are met, do nothing
    function updateTrackState(uint trackHash, int8 trackGenre)internal {
        Track storage track = trackRegistry[trackHash]; 
        
        if(uint8(track.trackState) == uint8 (TrackState.SANDBOX) &amp;&amp; track.trackRating &gt; WhitelistThreshold) { 
            uint8(track.trackState) == uint8(TrackState.WHITELIST); 
            playlist[trackHash] = track;  
            applyWhitelistPenalty(trackHash); 
        }else if(uint8(track.trackState) == uint8(TrackState.SANDBOX) &amp;&amp; track.trackRating &lt; BlacklistThreshold) { 
            uint8(track.trackState) == uint8(TrackState.BLACKLIST); 
            applyBlacklistPenalty(trackHash, trackGenre); 
            delete trackRegistry[trackHash]; 
            delete playlist[trackHash]; 
            noOfTracks.sub(1) ; 
        }
    }
&nbsp;
&nbsp;
    // @notice penalize voters who rejected tracks that are WHITELISTed
    // @notice retrieve track information from registry
    // @notice retrieve track rating
    // @notice calculate penalty score
    // @notice create temporary address type of user ID
    // @notice get the length of array containing the address of all users who voted reject on track
    // @notice loop through all voters of reject and apply penalty
    // @notice retrieve user ids
    // @notice apply penalty 
    function applyWhitelistPenalty(uint trackHash)internal view{
        Track storage track = trackRegistry[trackHash]; 
        int16 _trackRating = track.trackRating; 
        int8 penalityScore = int8(uint256(_trackRating).sub(uint256(WhitelistThreshold))); 
        address _userAddress; 
        uint length = track.rejects.length; 
                
            for(uint i=0; i&lt;length ; i++){ 
<span class="cstat-no" title="statement not covered" >                _userAddress = track.rejects[i]</span>;
                userRegistry[_userAddress].vouchCredits.sub(uint256(penalityScore)); 
            }
            //return true;
        }    
&nbsp;
    // @notice penalize voters who vouched for tracks that are BLACKLISTed
    // @notice retrieve track information from registered
    // @notice retrieve genre average score
    // @notice calculate penalty score
    // @notice create temporary address type of user ID
    // @notice get the length of array containing the address of all users who voted vouch on track
    // @notice loop through all voters of vouch on the track and apply penalty
    // @notice retrieve user id
    // @notice apply penalty
    function applyBlacklistPenalty(uint trackHash, int8 _genre)internal returns(bool){
        Track storage track = trackRegistry[trackHash];  
        int8 _averageScore = genreRegistry[_genre].averageScore; 
        int8 penalityScore = int8(uint256(_averageScore).mul(uint256(PunishmentMultiplier)));  
        address _userAddress; 
        uint length = track.vouches.length;  
                
            for(uint i=0; i&lt;length ; i++){  
                _userAddress = track.vouches[i];
               userRegistry[_userAddress].rejectCredits = userRegistry[_userAddress].rejectCredits.add(uint256(penalityScore));  
            }
            return true;
        }
&nbsp;
    // @notice function to update arrays within tracks that contain all user ids of all vouches and rejections
    // @notice retrieve track information from register
    // @notice update array of users who vouched for the track
    // @notice update array of users who rejected the track
    function updateuserAddressToVote(uint trackHash, int8 didVouch,address userAddress)internal{        
        Track storage track = trackRegistry[trackHash]; 
        if(didVouch == 1){
            track.vouches.push(userAddress); 
        }
        else <span class="missing-if-branch" title="else path not taken" >E</span>if(didVouch == -1){
            track.rejects.push(userAddress); 
        } 
    }    
    
    
    // @notice this function assigns credits to users appropriately based on vote type(vouch/reject)
    // @notice retrieve track information from registry
    // @notice update average score
    function updateTrackRating(uint trackHash, int8 didVouch)internal{
        Track storage track = trackRegistry[trackHash]; 
&nbsp;
        if(didVouch == 1){
        track.trackRating = int8(uint256(track.trackRating)+(uint256(didVouch))); 
        }
        else <span class="missing-if-branch" title="else path not taken" >E</span>if(didVouch == -1){
        track.trackRating= int8(uint256(track.trackRating)-(uint256(1)));        
        } 
        }    
    
    
    // @notice this function checks if user is allowed to vote based on daily vote limits 
    // @notice check if its the first time the user is voting
    // @notice set expiration time
    // @notice increase the number of votes the user has made in a day
    // @notice check if time is expired
    // @notice expiration time is due, so reset expiration time
    // @notice increment user votes in a day if expiration time is passed
    // @notice check if user has exceeded number of allowed votes in a day
    // @notice increment user votes in a day if less than limit
    function updateNumberOfVotesPerDay(address userAddress)internal returns (bool){
        int8 maxNoVotesInADay = 10;
&nbsp;
        if (timeOfVoteExpiry[userAddress] == 0){ 
            timeOfVoteExpiry[userAddress] = now + 1 days;
            userRegistry[userAddress].noOfVotesInDay  = 1; 
            return true;            
       } else{
            uint expirationTime = timeOfVoteExpiry[userAddress];
&nbsp;
            if (now &lt; expirationTime &amp;&amp; maxNoVotesInADay &gt; userRegistry[userAddress].noOfVotesInDay){ 
                userRegistry[userAddress].noOfVotesInDay = int8(uint256(userRegistry[userAddress].noOfVotesInDay).add(uint256(1))); 
                return true; 
                
        }else{
        return false;
    }
          } 
    }      
&nbsp;
&nbsp;
    // @notice this function updates all subsequent user credits based on vote type
    // @notice retrieve track information from registry
    // @notice if the vote is a reject, then loop through all previous rejects and increment all address with a reject credit of +1 
    // @notice get array length of previous addressed who have voted reject   
    // @notice retrieve user ids   
    // @notice update all previous users with relevant reject credits
    // @notice  update users reject credits
    // @notice update vouch/reject array with users vote type
    // @notice if the vote is a vouch, then loop through all previous vouches and increment all address with a vouch credit of +1 
    // @notice get array length of previous addressed who have vouched   
    // @notice retrieve user ids
    // @notice update all previous users with relevant vouch credits
    // @notice update users reject credits
    // @notice update vouch/reject array with users vote type
    function updateCredits(uint trackHash, int8 didVouch, address userAddress)internal{       
        Track storage track = trackRegistry[trackHash];  
        User storage user = userRegistry[userAddress];
        address _userAddress;
        uint length;
        uint i;
        
        if (didVouch == -1){      
            length = track.rejects.length;          
            for(i=0; i&lt;length ; i++){
                _userAddress = track.rejects[i];
                userRegistry[_userAddress].rejectCredits++;  
            }
            user.rejectCredits++; 
            updateuserAddressToVote(trackHash, didVouch,userAddress); 
        } 
        else <span class="missing-if-branch" title="else path not taken" >E</span>if(didVouch == 1 ){   
            length = track.vouches.length; 
                
            for(i=0; i&lt;length ; i++){
                _userAddress = track.vouches[i];
                userRegistry[_userAddress].vouchCredits++; 
            }
            user.vouchCredits++; 
            updateuserAddressToVote(trackHash, didVouch,userAddress); 
            } 
    }    
}
    
    
    
 
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Sun Mar 03 2019 11:54:25 GMT-0500 (Eastern Standard Time)
</div>
</div>
<script src="../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../sorter.js"></script>
</body>
</html>
